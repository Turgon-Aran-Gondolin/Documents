(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47444,       1251]
NotebookOptionsPosition[     45428,       1182]
NotebookOutlinePosition[     45775,       1197]
CellTagsIndexPosition[     45732,       1194]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Definition", "Subsection",
 InitializationGroup->True,
 CellChangeTimes->{{3.666417992207283*^9, 3.6664179947470903`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]a", "[", "r_", "]"}], "=", 
   FractionBox[
    SuperscriptBox["E", 
     FractionBox[
      RowBox[{"-", 
       SuperscriptBox["r", "2"]}], 
      RowBox[{"2", 
       SuperscriptBox["a", "2"]}]]], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"2", "\[Pi]"}], ")"}], 
      FractionBox["3", "2"]], 
     SuperscriptBox["a", "3"]}]]}], ";", 
  RowBox[{"\[Alpha]", "=", 
   RowBox[{"Rationalize", "@", "0.2"}]}], ";", 
  RowBox[{"u0", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "20"}]]}], ";", 
  RowBox[{"\[Delta]start", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "10"}]]}], ";", 
  RowBox[{"m", "=", "1"}], ";", 
  RowBox[{"\[Alpha]Sch", "=", 
   RowBox[{"2", "m"}]}], ";", 
  RowBox[{"ee", "=", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["10", 
      RowBox[{"-", "10"}]], ",", 
     SuperscriptBox["10", 
      RowBox[{"-", "5"}]], ",", "0.001", ",", "0.003", ",", "0.007", ",", 
     "0.01", ",", "0.03", ",", "0.07", ",", "0.1", ",", "0.3", ",", "0.7", 
     ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Vs1", "[", 
    RowBox[{"r_", ",", "a_", ",", "c1_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", " ", 
      FractionBox["\[Alpha]", "r"]}], 
     RowBox[{"Erf", "[", 
      FractionBox["r", 
       RowBox[{
        SqrtBox["2"], "a"}]], "]"}]}], "+", 
    RowBox[{"c1", " ", 
     SuperscriptBox["a", "2"], 
     RowBox[{"\[Delta]a", "[", "r", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Vs2", "[", 
    RowBox[{"r_", ",", "a_", ",", 
     RowBox[{"{", 
      RowBox[{"c2_", ",", "d1_"}], "}"}]}], "]"}], "=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", " ", 
         FractionBox["1", "#"]}], 
        RowBox[{"Erf", "[", 
         FractionBox["#", 
          RowBox[{
           SqrtBox["2"], "a"}]], "]"}]}], "+", 
       RowBox[{"c2", " ", 
        SuperscriptBox["a", "2"], 
        RowBox[{"\[Delta]a", "[", "#", "]"}]}], "+", 
       RowBox[{"d1", " ", 
        SuperscriptBox["a", "4"], 
        RowBox[{"Laplacian", "[", 
         RowBox[{
          RowBox[{"Rationalize", "@", 
           RowBox[{"\[Delta]a", "[", "#", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"#", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
          "\"\<Spherical\>\""}], "]"}]}]}], "&"}], "[", "r", "]"}], "]"}]}], 
  ";", 
  RowBox[{
   RowBox[{"V", "[", "r_", "]"}], "=", 
   FractionBox[
    RowBox[{"-", "\[Alpha]"}], "r"]}], ";"}]}], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.666417486872492*^9, 3.666417488262471*^9}, {
   3.666417537666355*^9, 3.6664175483018646`*^9}, {3.666417585757308*^9, 
   3.6664176151340513`*^9}, {3.666417684010681*^9, 3.6664176888130713`*^9}, {
   3.6664178590972996`*^9, 3.6664178812579565`*^9}, {3.666424795562386*^9, 
   3.6664247978790216`*^9}, 3.666566022153719*^9, {3.666567146905137*^9, 
   3.66656717365539*^9}, 3.666573386147797*^9, {3.6666477443894653`*^9, 
   3.6666477536820345`*^9}, {3.6666483012032757`*^9, 3.666648301417427*^9}, {
   3.6666743489053583`*^9, 3.666674351470173*^9}, {3.6666867187360544`*^9, 
   3.666686729979374*^9}, 3.66677510924329*^9, 3.6667773091778197`*^9, {
   3.6668407102990923`*^9, 3.666840712978998*^9}, 3.6668408054151573`*^9, {
   3.6690985377376394`*^9, 3.6690985439390125`*^9}, {3.6691598000683737`*^9, 
   3.669159803584029*^9}, {3.66916020780611*^9, 3.669160211368644*^9}, {
   3.669203868614794*^9, 3.669203871901614*^9}, {3.669288923833776*^9, 
   3.6692889301842723`*^9}, {3.6693382992435455`*^9, 
   3.6693383027123227`*^9}, {3.669338485620528*^9, 3.6693384996050587`*^9}, {
   3.669339032470111*^9, 3.66933903929832*^9}, 3.670202037452634*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RS", "[", 
    RowBox[{"n_", ",", "r_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     FractionBox["2", 
      RowBox[{
       SuperscriptBox["A", 
        FractionBox["3", "2"]], " ", 
       SuperscriptBox["n", 
        RowBox[{"3", "/", "2"}]]}]], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox["r", 
        RowBox[{"n", " ", "A"}]]}]], " ", 
     RowBox[{"Hypergeometric1F1", "[", 
      RowBox[{
       RowBox[{"1", "-", "n"}], ",", "2", ",", 
       FractionBox[
        RowBox[{"2", " ", "r"}], 
        RowBox[{"n", " ", "A"}]]}], "]"}]}], "/.", 
    RowBox[{"A", "\[Rule]", 
     RowBox[{"Rationalize", "@", 
      FractionBox["1", 
       RowBox[{"m", " ", "\[Alpha]"}]]}]}]}]}], ";"}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.6664257381639*^9, {3.666425770008382*^9, 3.6664257879910784`*^9}, {
   3.666425888144794*^9, 3.6664258917063065`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RealEigenEnergy", "[", "n_", "]"}], "=", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"m", " ", 
      SuperscriptBox["\[Alpha]", "2"]}], 
     RowBox[{"2", 
      SuperscriptBox["n", "2"]}]]}]}], ";"}], "\n", 
 RowBox[{"Table20REE", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"RealEigenEnergy", "[", "n", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "20"}], "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.666688591266756*^9, 3.6666886210456066`*^9}, {
   3.6666886741952395`*^9, 3.6666886791668997`*^9}, {3.666688892862154*^9, 
   3.666688902843853*^9}, 3.6666889704967747`*^9, 3.6667488610076027`*^9, 
   3.6667730647922926`*^9, 3.6691583255825596`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "50"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "200"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "450"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "800"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "1250"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "1800"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "2450"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "3200"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "4050"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "5000"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "6050"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "7200"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "8450"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "9800"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "11250"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "12800"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "14450"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "16200"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "18050"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "20000"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.670202029093164*^9, 3.670202976488371*^9, 
  3.6702033625310345`*^9, 3.670203481528262*^9, 3.670204378006876*^9, 
  3.6702045168058105`*^9, 3.6702109599346027`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<NumericalCalculus`\>\"", "]"}]], "Input",
 InitializationCell->True,
 InitializationGroup->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EigenEnergy", "[", 
   RowBox[{"V_", ",", "\[Alpha]Sch_", ",", 
    RowBox[{"{", 
     RowBox[{"min_", ",", "max_"}], "}"}], ",", 
    RowBox[{"{", "opt1___", "}"}], ",", 
    RowBox[{"{", "opt2___", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sol", ",", "ef", ",", "evShifted", ",", "evnew", ",", 
      RowBox[{"steps", "=", "\[Infinity]"}], ",", "time1", ",", "time2"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PrintTemporary", "[", "V", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"shift", "=", "10"}], ",", 
           RowBox[{"d", "=", "1000"}], ",", 
           RowBox[{"n", "=", "20"}], ",", "ev"}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ev", ",", "ef"}], "}"}], "=", 
           RowBox[{"NDEigensystem", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"shift", " ", 
                 RowBox[{"f", "[", "r", "]"}]}], "+", 
                RowBox[{"V", " ", 
                 RowBox[{"f", "[", "r", "]"}]}], "-", 
                RowBox[{
                 RowBox[{"1", "/", "\[Alpha]Sch"}], " ", 
                 RowBox[{
                  RowBox[{"f", "''"}], "[", "r", "]"}]}]}], 
               RowBox[{"(*", 
                RowBox[{"+", 
                 RowBox[{"NeumannValue", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"r", "\[Equal]", "d"}]}], "]"}]}], "*)"}], ",", 
               RowBox[{"DirichletCondition", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"f", "[", "r", "]"}], "\[Equal]", "0"}], ",", 
                 "True"}], "]"}]}], "}"}], ",", 
             RowBox[{"f", "[", "r", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", "0", ",", "d"}], "}"}], ",", "n", ",", 
             RowBox[{"Method", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<FiniteElement\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"\"\<MeshOptions\>\"", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<MaxCellMeasure\>\"", "\[Rule]", "0.05"}], 
                    "}"}]}], "}"}]}], "}"}]}], ",", 
                RowBox[{"\"\<Eigensystem\>\"", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<Arnoldi\>\"", ",", 
                   RowBox[{"MaxIterations", "->", "Infinity"}]}], "}"}]}]}], 
               "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"evShifted", "=", 
           RowBox[{"ev", "-", "shift"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "evShifted", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"ParametricNDSolve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"V", " ", 
             RowBox[{"u", "[", "r", "]"}]}], "-", 
            RowBox[{
             RowBox[{"1", "/", "\[Alpha]Sch"}], " ", 
             RowBox[{
              RowBox[{"u", "''"}], "[", "r", "]"}]}]}], "\[Equal]", 
           RowBox[{"e", " ", 
            RowBox[{"u", "[", "r", "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"u", "'"}], "[", "max", "]"}], "\[Equal]", 
           RowBox[{"-", "min"}]}], ",", 
          RowBox[{
           RowBox[{"u", "[", "max", "]"}], "\[Equal]", "min"}]}], "}"}], ",", 
        "u", ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "min", ",", "max"}], "}"}], ",", "e", ",", 
        RowBox[{"MaxSteps", "\[Rule]", "steps"}], ",", "opt1"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"evnew", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"e", "/.", "#"}], "&"}], "/@", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"PrintTemporary", "[", "n", "]"}], ";", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"u", "[", "e", "]"}], "[", "min", "]"}], "\[Equal]", 
              "0"}], "/.", "sol"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"e", ",", 
                RowBox[{"0.99", " ", 
                 RowBox[{"SetPrecision", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], ",", "3"}], "]"}]}], ",", 
                RowBox[{"1.01", " ", 
                 RowBox[{"SetPrecision", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], ",", "3"}], "]"}]}]}], 
               "}"}], "&"}], "[", "Table20REE", "]"}], ",", "opt2"}], 
           RowBox[{"(*", 
            RowBox[{",", 
             RowBox[{"StepMonitor", "\[RuleDelayed]", 
              RowBox[{"PrintTemporary", "[", "e", "]"}]}]}], "*)"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "20"}], "}"}]}], "]"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]50e", "[", 
   RowBox[{"en_", ",", "V_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sol", ",", "\[Delta]s", ",", "\[Delta]r", ",", 
      RowBox[{"r1", "=", "50"}], ",", 
      RowBox[{"r2", "=", "u0"}], ",", "\[Beta]", ",", "jder", ",", "nder", 
      ",", "k", ",", 
      RowBox[{"wpc", "=", "50"}], ",", 
      RowBox[{"prc", "=", "20"}], ",", "time1", ",", "time2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"time1", "=", 
      RowBox[{"SessionTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      SqrtBox[
       RowBox[{"2", "en"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]", ":=", 
      RowBox[{
       RowBox[{"r1", " ", 
        FractionBox[
         RowBox[{
          RowBox[{"u", "'"}], "[", "r1", "]"}], 
         RowBox[{"u", "[", "r1", "]"}]]}], "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"jder", "[", "r_", "]"}], "=", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"SphericalBesselJ", "[", 
         RowBox[{"0", ",", "r"}], "]"}], ",", "r"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nder", "[", "r_", "]"}], "=", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"SphericalBesselY", "[", 
         RowBox[{"0", ",", "r"}], "]"}], ",", "r"}], "]"}]}], ";", 
     RowBox[{"sol", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"u", "''"}], "[", "r", "]"}], "+", 
             RowBox[{"\[Alpha]Sch", 
              RowBox[{"(", 
               RowBox[{"en", "-", "V"}], ")"}], 
              RowBox[{"u", "[", "r", "]"}]}]}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"u", "'"}], "[", "r2", "]"}], "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{"u", "[", "r2", "]"}], "\[Equal]", "u0"}]}], "}"}], ",", 
         "u", ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "r1", ",", "r2"}], "}"}], ",", 
         RowBox[{"PrecisionGoal", "\[Rule]", "prc"}], ",", 
         RowBox[{"WorkingPrecision", "\[Rule]", "wpc"}], ",", " ", 
         RowBox[{"MaxSteps", "\[Rule]", "Infinity"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "All"}]}], 
        RowBox[{"(*", 
         RowBox[{",", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Shooting\>\"", ",", 
             RowBox[{"\"\<StartingInitialConditions\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"u", "[", "r2", "]"}], "\[Equal]", "u0"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"u", "'"}], "[", "r2", "]"}], "\[Equal]", "1"}]}], 
               "}"}]}]}], "}"}]}]}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{",", 
          RowBox[{"SolveDelayed", "\[Rule]", "True"}]}], "*)"}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Delta]s", "=", 
      RowBox[{"FindRoot", "[", 
       RowBox[{"(*", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"u", "'"}], "[", "r1", "]"}], 
          RowBox[{"u", "[", "r1", "]"}]], "\[Equal]", 
         RowBox[{"k", " ", 
          RowBox[{"Cot", "[", 
           RowBox[{
            RowBox[{"k", " ", "r1"}], "+", "\[Delta]"}], "]"}]}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Tan", "[", "\[Delta]", "]"}], "\[Equal]", 
          FractionBox[
           RowBox[{
            RowBox[{"k", " ", "r1", " ", 
             RowBox[{"jder", "[", 
              RowBox[{"k", " ", "r1"}], "]"}]}], "-", 
            RowBox[{"\[Beta]", " ", 
             RowBox[{"SphericalBesselJ", "[", 
              RowBox[{"0", ",", 
               RowBox[{"k", " ", "r1"}]}], "]"}]}]}], 
           RowBox[{
            RowBox[{"k", " ", "r1", " ", 
             RowBox[{"nder", "[", 
              RowBox[{"k", " ", "r1"}], "]"}]}], "-", 
            RowBox[{"\[Beta]", " ", 
             RowBox[{"SphericalBesselY", "[", 
              RowBox[{"0", ",", 
               RowBox[{"k", " ", "r1"}]}], "]"}]}]}]]}], 
         RowBox[{"(*", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"u", "'"}], "[", "r1", "]"}], 
            RowBox[{"u", "[", "r1", "]"}]], "\[Equal]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"k", "+", 
              FractionBox["1", 
               RowBox[{"k", " ", "r1"}]]}], ")"}], " ", 
            RowBox[{"Cot", "[", 
             RowBox[{
              RowBox[{"k", " ", "r1"}], "+", "\[Delta]", "+", 
              FractionBox[
               RowBox[{"Log", "[", 
                RowBox[{"2", " ", "k", " ", "r1"}], "]"}], "k"]}], "]"}]}]}], 
          "*)"}], "/.", "sol"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Delta]", ",", "0"}], "}"}], ",", 
        RowBox[{"WorkingPrecision", "\[Rule]", "wpc"}], ",", 
        RowBox[{"PrecisionGoal", "\[Rule]", "prc"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Delta]r", "=", 
      RowBox[{"\[Delta]", "/.", "\[Delta]s"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"time2", "=", 
      RowBox[{"SessionTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<End with \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"time2", "-", "time1"}], "]"}], "<>", "\"\<s\>\""}], "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Delta]r", "=", 
      RowBox[{"NestWhile", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Sign", "[", "#", "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Abs", "[", "#", "]"}], "-", "\[Pi]"}], ")"}]}], "&"}], 
        ",", "\[Delta]r", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "#", "]"}], ">", 
          FractionBox["\[Pi]", "2"]}], "&"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]50", "[", "V_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "en", ",", "len", ",", "\[Delta]en", ",", "timestampa", ",", 
      "timestampb"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"len", "=", 
      RowBox[{"Length", "@", "ee"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"timestampa", "=", 
         RowBox[{"SessionTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"en", "=", 
         RowBox[{"ee", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Delta]en", "=", 
         RowBox[{"\[Delta]50e", "[", 
          RowBox[{"en", ",", "V"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"timestampb", "=", 
         RowBox[{"SessionTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"PrintTemporary", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"en", ",", "\[Delta]en"}], "}"}], ",", "\"\<    \>\"", ",", 
          RowBox[{"timestampb", "-", "timestampa"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[Delta]en"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "len"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Eigenfun", "[", 
   RowBox[{"V_", ",", "enelist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r1", "=", "2000"}], ",", 
            RowBox[{"r2", "=", 
             RowBox[{"1.", "*", 
              SuperscriptBox["10", 
               RowBox[{"-", "50"}]]}]}]}], "}"}], ",", 
          RowBox[{"NDSolve", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"V", " ", 
                 RowBox[{"f", "[", "r", "]"}]}], "-", 
                RowBox[{
                 RowBox[{"1", "/", "\[Alpha]Sch"}], " ", 
                 RowBox[{
                  RowBox[{"f", "''"}], "[", "r", "]"}]}]}], "\[Equal]", 
               RowBox[{"#", " ", 
                RowBox[{"f", "[", "r", "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"f", "[", "r1", "]"}], "\[Equal]", "r2"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"f", "'"}], "[", "r1", "]"}], "\[Equal]", 
               RowBox[{"-", "r2"}]}]}], "}"}], ",", "f", ",", 
            RowBox[{"{", 
             RowBox[{"r", ",", "r1", ",", "r2"}], "}"}], ",", 
            RowBox[{"WorkingPrecision", "\[Rule]", "50"}], ",", 
            RowBox[{"AccuracyGoal", "\[Rule]", "30"}], ",", 
            RowBox[{"PrecisionGoal", "\[Rule]", "15"}], ",", 
            RowBox[{"InterpolationOrder", "\[Rule]", "All"}], ",", 
            RowBox[{"MaxSteps", "\[Rule]", "Infinity"}], ",", 
            RowBox[{"MaxStepSize", "\[Rule]", "0.01"}], ",", 
            RowBox[{"Method", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<Shooting\>\"", ",", 
               RowBox[{"\"\<StartingInitialConditions\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"f", "'"}], "[", "r2", "]"}], "\[Equal]", "1"}], 
                  ",", 
                  RowBox[{
                   RowBox[{"f", "[", "r2", "]"}], "\[Equal]", "r2"}]}], 
                 "}"}]}]}], "}"}]}]}], "]"}]}], "]"}], "&"}], "/@", 
       "enelist"}], ",", "2"}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.666417373753624*^9, 3.6664173791544375`*^9}, {
   3.666417802039014*^9, 3.6664178166012964`*^9}, 3.6664757004920883`*^9, {
   3.666501266761839*^9, 3.6665013312693853`*^9}, {3.666510502208707*^9, 
   3.666510573060545*^9}, {3.6665106362904396`*^9, 3.6665106799050555`*^9}, {
   3.6665218088040285`*^9, 3.666521812413436*^9}, {3.6665633342236495`*^9, 
   3.6665633422549744`*^9}, {3.6666467781952343`*^9, 3.666646793914403*^9}, {
   3.6666475138552003`*^9, 3.6666475171989822`*^9}, {3.666649289994234*^9, 
   3.666649316980308*^9}, {3.666676170118725*^9, 3.6666761749625163`*^9}, {
   3.666682632874029*^9, 3.6666826570151143`*^9}, {3.6666869439364667`*^9, 
   3.6666870334810276`*^9}, 3.6666870896252766`*^9, {3.6666881714156904`*^9, 
   3.6666881714755907`*^9}, {3.6666882036739388`*^9, 3.6666882630511928`*^9}, 
   3.666690129039649*^9, {3.666690278248773*^9, 3.6666903366130366`*^9}, 
   3.666691937383771*^9, 3.666694723967981*^9, 3.6666950807435417`*^9, {
   3.666732715302289*^9, 3.6667327292946377`*^9}, {3.6667373104968247`*^9, 
   3.666737341903592*^9}, 3.6667374388426294`*^9, {3.666748443354139*^9, 
   3.6667484880917606`*^9}, {3.6667485368745165`*^9, 3.666748548317691*^9}, {
   3.6667485800794*^9, 3.666748658462243*^9}, {3.6667490000430093`*^9, 
   3.666749053055306*^9}, {3.666749087596133*^9, 3.66674908874795*^9}, {
   3.6667491292737026`*^9, 3.666749161891721*^9}, {3.6667492347858353`*^9, 
   3.6667492553052664`*^9}, {3.6667494409221516`*^9, 
   3.6667494419519453`*^9}, {3.6668369424079247`*^9, 
   3.6668369501191993`*^9}, {3.6668372966103487`*^9, 
   3.6668373460483427`*^9}, {3.666837449846157*^9, 3.666837450283661*^9}, 
   3.6668376534214144`*^9, 3.666837868335187*^9, 3.6668408406777973`*^9, {
   3.6691014040481606`*^9, 3.669101421983849*^9}, {3.669115164092394*^9, 
   3.669115178631667*^9}, 3.669115210474123*^9, {3.6691583486452494`*^9, 
   3.669158354551547*^9}, {3.669158467068059*^9, 3.6691584745837336`*^9}, 
   3.669168347281615*^9, {3.669195762320343*^9, 3.6691957652894363`*^9}, {
   3.6692889191054296`*^9, 3.669288920906205*^9}, {3.669289247976565*^9, 
   3.6692892562929525`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Eigenfunsin", "[", 
   RowBox[{"V_", ",", "ene_", ",", "rr_", ",", 
    RowBox[{"{", 
     RowBox[{"r1_", ",", "r2_"}], "}"}], ",", "opt___"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"efunction", ",", "amplitude"}], "}"}], ",", 
    RowBox[{
     RowBox[{"efunction", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"V", " ", 
               RowBox[{"f", "[", "r", "]"}]}], "-", 
              RowBox[{
               RowBox[{"1", "/", "\[Alpha]Sch"}], " ", 
               RowBox[{
                RowBox[{"f", "''"}], "[", "r", "]"}]}]}], "\[Equal]", 
             RowBox[{"ene", " ", 
              RowBox[{"f", "[", "r", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"f", "[", "r1", "]"}], "\[Equal]", "r2"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"f", "'"}], "[", "r1", "]"}], "\[Equal]", 
             RowBox[{"-", "r2"}]}]}], "}"}], ",", "f", ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "r1", ",", "r2"}], "}"}], ",", "opt", ",", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Shooting\>\"", ",", 
             RowBox[{"\"\<StartingInitialConditions\>\"", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"f", "'"}], "[", "r2", "]"}], "\[Equal]", "1"}], 
                ",", 
                RowBox[{
                 RowBox[{"f", "[", "r2", "]"}], "\[Equal]", "r2"}]}], 
               "}"}]}]}], "}"}]}]}], "]"}], ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"amplitude", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"f", "[", "r", "]"}], "2"], "/.", "#"}], ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", "r2", ",", "r1"}], "}"}]}], "]"}], 
         RowBox[{"-", "0.5"}]], "&"}], "/@", "efunction"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"amplitude", " ", 
       RowBox[{"f", "[", "rr", "]"}]}], "/.", "efunction"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.666521787631962*^9, 3.6665218555856996`*^9}, {
   3.666521908851806*^9, 3.666522004649561*^9}, {3.6670894604238157`*^9, 
   3.6670894612093716`*^9}, 3.667095133064227*^9, 3.667099562354955*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EigenEnergySolo", "[", 
   RowBox[{"V_", ",", "\[Alpha]Sch_", ",", 
    RowBox[{"{", 
     RowBox[{"min_", ",", "max_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"estart_", ",", "eend___"}], "}"}], ",", 
    RowBox[{"{", "opt1___", "}"}], ",", 
    RowBox[{"{", "opt2___", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sol", ",", "ef", ",", "evShifted", ",", "evnew", ",", 
      RowBox[{"steps", "=", "\[Infinity]"}], ",", "time1", ",", "time2"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PrintTemporary", "[", "V", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"ParametricNDSolve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"V", " ", 
             RowBox[{"u", "[", "r", "]"}]}], "-", 
            RowBox[{
             RowBox[{"1", "/", "\[Alpha]Sch"}], " ", 
             RowBox[{
              RowBox[{"u", "''"}], "[", "r", "]"}]}]}], "\[Equal]", 
           RowBox[{"e", " ", 
            RowBox[{"u", "[", "r", "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"u", "[", "max", "]"}], "\[Equal]", "min"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"u", "'"}], "[", "max", "]"}], "\[Equal]", 
           RowBox[{"-", "min"}]}]}], "}"}], ",", "u", ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "min", ",", "max"}], "}"}], ",", "e", ",", 
        RowBox[{"MaxSteps", "\[Rule]", "steps"}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"StepMonitor", "\[RuleDelayed]", 
           RowBox[{"PrintTemporary", "[", 
            RowBox[{"{", 
             RowBox[{"r", ",", 
              RowBox[{
               RowBox[{"u", "[", "e", "]"}], "[", "r", "]"}]}], "}"}], 
            "]"}]}], ","}], "*)"}], "opt1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"{", 
       RowBox[{"estart", ",", "eend"}], "}"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"time2", "=", 
      RowBox[{"SessionTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"evnew", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"e", "/.", "#"}], "&"}], "/@", "\[IndentingNewLine]", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"u", "[", "e", "]"}], "[", "min", "]"}], "\[Equal]", 
           "0"}], "/.", "sol"}], ",", 
         RowBox[{"{", 
          RowBox[{"e", ",", "estart", ",", "eend"}], "}"}], ",", "opt2", ",", 
         RowBox[{"StepMonitor", "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"time1", "=", "time2"}], ";", 
            RowBox[{"time2", "=", 
             RowBox[{"SessionTime", "[", "]"}]}], ";", 
            RowBox[{"Print", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"e", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"u", "[", "e", "]"}], "[", "min", "]"}], "/.", 
                 "sol"}]}], "}"}], ",", "\"\<time:\>\"", ",", 
              RowBox[{"time2", "-", "time1"}], ",", "\"\<s\>\""}], "]"}]}], 
           "}"}]}]}], "]"}]}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6667494515954227`*^9, 3.6667495100336084`*^9}, {
   3.666749554291416*^9, 3.6667495638844633`*^9}, {3.666749962765308*^9, 
   3.666749980036273*^9}, {3.6667741491237087`*^9, 3.6667741494329276`*^9}, {
   3.6667747406485143`*^9, 3.6667747704826393`*^9}, 3.6667748723938026`*^9, {
   3.6667793169319077`*^9, 3.666779323346462*^9}, {3.6667811128405952`*^9, 
   3.6667811640558615`*^9}, {3.6667812055382338`*^9, 3.666781218198199*^9}, {
   3.6668381693677716`*^9, 3.6668381726647096`*^9}, 3.6668641116302853`*^9, {
   3.6668642155973454`*^9, 3.6668642436474576`*^9}, {3.66686429557537*^9, 
   3.6668642962316275`*^9}, 3.6668643317874355`*^9, {3.6668714076801724`*^9, 
   3.666871553325186*^9}, {3.6668722277084093`*^9, 3.666872228880289*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]expminus10", "=", 
   RowBox[{"\[Delta]50e", "[", 
    RowBox[{
     SuperscriptBox["10", 
      RowBox[{"-", "10"}]], ",", 
     RowBox[{"V", "[", "r", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]expminus9", "=", 
   RowBox[{"\[Delta]50e", "[", 
    RowBox[{
     SuperscriptBox["10", 
      RowBox[{"-", "9"}]], ",", 
     RowBox[{"V", "[", "r", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]expminus5", "=", 
   RowBox[{"\[Delta]50e", "[", 
    RowBox[{
     SuperscriptBox["10", 
      RowBox[{"-", "5"}]], ",", 
     RowBox[{"V", "[", "r", "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\[Delta]50V", "=", 
    RowBox[{"\[Delta]50", "[", 
     RowBox[{"V", "[", "r", "]"}], "]"}]}], "*)"}]}]}], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.666476576386056*^9, 3.6664765839323807`*^9}, 
   3.666517983315971*^9, 3.669101426786246*^9, {3.669102317556268*^9, 
   3.669102318293783*^9}, {3.6691030066764402`*^9, 3.669103011783065*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "precw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The precision of the argument function \
(\[NoBreak]\\!\\(\\*RowBox[{RowBox[{\\\"Tan\\\", \\\"[\\\", \\\"\[Delta]\\\", \
\\\"]\\\"}], \\\"\[Equal]\\\", RowBox[{\\\"-\\\", \
\\\"0.001227018787645673836841755523317231850821329724849654031522981868132631\
63405`48.54551952673358\\\"}]}]\\)\[NoBreak]) is less than WorkingPrecision (\
\[NoBreak]\\!\\(\\*RowBox[{\\\"50.`\\\"}]\\)\[NoBreak]). \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/precw\\\", \
ButtonNote -> \\\"FindRoot::precw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6702020299213195`*^9, 3.6702029770017686`*^9, 
  3.6702033630874653`*^9, 3.6702034821046543`*^9, 3.6702043788037734`*^9, 
  3.6702045172921553`*^9, 3.6702109604658566`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "precw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The precision of the argument function \
(\[NoBreak]\\!\\(\\*RowBox[{RowBox[{\\\"Tan\\\", \\\"[\\\", \\\"\[Delta]\\\", \
\\\"]\\\"}], \\\"\[Equal]\\\", RowBox[{\\\"-\\\", \
\\\"0.003880187974997173867746153287016616045116125976626275083995420251262585\
59787`48.545518792179436\\\"}]}]\\)\[NoBreak]) is less than WorkingPrecision \
(\[NoBreak]\\!\\(\\*RowBox[{\\\"50.`\\\"}]\\)\[NoBreak]). \\!\\(\\*ButtonBox[\
\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/precw\\\", ButtonNote -> \
\\\"FindRoot::precw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6702020299213195`*^9, 3.6702029770017686`*^9, 
  3.6702033630874653`*^9, 3.6702034821046543`*^9, 3.6702043788037734`*^9, 
  3.6702045172921553`*^9, 3.6702109607002196`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "precw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The precision of the argument function \
(\[NoBreak]\\!\\(\\*RowBox[{RowBox[{\\\"Tan\\\", \\\"[\\\", \\\"\[Delta]\\\", \
\\\"]\\\"}], \\\"\[Equal]\\\", RowBox[{\\\"-\\\", \
\\\"0.404156627007639584978651878117832141994498911906335200687945948056077474\
76913`48.53709470660538\\\"}]}]\\)\[NoBreak]) is less than WorkingPrecision (\
\[NoBreak]\\!\\(\\*RowBox[{\\\"50.`\\\"}]\\)\[NoBreak]). \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/precw\\\", \
ButtonNote -> \\\"FindRoot::precw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6702020299213195`*^9, 3.6702029770017686`*^9, 
  3.6702033630874653`*^9, 3.6702034821046543`*^9, 3.6702043788037734`*^9, 
  3.6702045172921553`*^9, 3.6702109609033613`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Determine ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "1"], TraditionalForm]]]
}], "Subsection",
 CellChangeTimes->{{3.6691003977194057`*^9, 3.6691004065476494`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hhhc1", "[", 
    RowBox[{"en_", ",", "a_", ",", 
     RowBox[{"c1_", "?", "NumberQ"}]}], "]"}], ":=", 
   RowBox[{"\[Delta]50e", "[", 
    RowBox[{"en", ",", 
     RowBox[{"Vs1", "[", 
      RowBox[{"r", ",", "a", ",", "c1"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"evnhhhc1", "[", "c1_", "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"hhhc1", "[", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "10"}]], ",", "a", ",", "c1"}], "]"}], "-", 
      "\[Delta]expminus10"}], ",", "8"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Determinec1", "[", 
   RowBox[{"a_", ",", 
    RowBox[{"{", 
     RowBox[{"start_", ",", "end___"}], "}"}], ",", "opt___"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "findroot", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "a", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"findroot", "=", 
      RowBox[{"FindRoot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"hhhc1", "[", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "10"}]], ",", "a", ",", "c1"}], "]"}], "\[Equal]", 
         "\[Delta]expminus10"}], ",", 
        RowBox[{"{", 
         RowBox[{"c1", ",", "start", ",", "end"}], "}"}], ",", "opt"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"c1", "/.", "findroot"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"c1", "/.", "findroot"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6664190867210665`*^9, 3.6664190950719748`*^9}, {
   3.666419276566107*^9, 3.6664192941523085`*^9}, {3.6668403818479347`*^9, 
   3.6668403875612288`*^9}, {3.6668404306231227`*^9, 3.6668404376630516`*^9}, 
   3.6668405235234013`*^9, {3.666840553793659*^9, 3.666840574683777*^9}, {
   3.666840608831425*^9, 3.666840609682505*^9}, 3.6668555785598283`*^9, {
   3.666857630997924*^9, 3.6668576330280128`*^9}, {3.6670067078016663`*^9, 
   3.6670067301017017`*^9}, {3.667008352100359*^9, 3.667008368991131*^9}, 
   3.6670084641326323`*^9, {3.667008545539601*^9, 3.6670085459614944`*^9}, {
   3.6691012266326885`*^9, 3.669101256872056*^9}, {3.669101464077609*^9, 
   3.6691014643488016`*^9}, {3.6691024836134996`*^9, 3.669102485364726*^9}, {
   3.6693385218552876`*^9, 3.6693385593713093`*^9}, {3.6693388935936403`*^9, 
   3.6693389192345266`*^9}, {3.669539306755033*^9, 3.669539314746245*^9}, {
   3.6695394110623617`*^9, 3.6695394560502043`*^9}, {3.669539541661409*^9, 
   3.669539567889257*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c1a", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.669538681913742*^9, 3.6695386859397907`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "table", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"table", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c1", ",", "a"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"a", "=", 
            SuperscriptBox["10", "loga"]}], ";", "\[IndentingNewLine]", 
           RowBox[{"c1", "=", 
            RowBox[{"Determinec1", "[", 
             RowBox[{"a", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"MaxIterations", "\[Rule]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"a", ">", "10"}], ",", "200", ",", "100"}], 
                  "]"}]}], ",", 
                RowBox[{"PrecisionGoal", "\[Rule]", "10"}], ",", 
                RowBox[{"WorkingPrecision", "\[Rule]", "50"}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"a", ",", "c1"}], "}"}]}]}], "]"}], "//", "Quiet"}], ",", 
       RowBox[{"{", 
        RowBox[{"loga", ",", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"2", ",", "1", ",", 
              RowBox[{"-", "0.01"}]}], "]"}], ",", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "0", ",", 
              RowBox[{"-", "0.01"}]}], "]"}], ",", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "0.1"}]}], "]"}], ",", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "3"}], ",", 
              RowBox[{"-", "0.4"}]}], "]"}], ",", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "3"}], ",", 
              RowBox[{"-", "5"}], ",", 
              RowBox[{"-", "0.5"}]}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"c1a", "=", 
     RowBox[{"DeleteDuplicates", "@", 
      RowBox[{"Sort", "[", 
       RowBox[{"c1a", "~", "Join", "~", "table"}], "]"}]}]}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.669621968524225*^9, 3.66962204048532*^9}, {
   3.669630748180925*^9, 3.669630762918254*^9}, 3.670203403093261*^9, {
   3.670204387694469*^9, 3.670204390413248*^9}, {3.670204449798854*^9, 
   3.6702044684605103`*^9}, {3.6702045505066767`*^9, 
   3.6702045507288036`*^9}, {3.670206663971213*^9, 3.6702067265951977`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["100.`"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.670206721748094*^9}],

Cell[BoxData["79.43282347242814`"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.670206721763719*^9}],

Cell[BoxData["63.09573444801933`"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.670206721779344*^9}],

Cell[BoxData["50.11872336272722`"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.670206721779344*^9}],

Cell[BoxData["39.810717055349734`"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.670206721794969*^9}],

Cell[BoxData["32.359365692962825`"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.670206721810594*^9}],

Cell[BoxData["26.302679918953814`"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.6702067218262196`*^9}],

Cell[BoxData["21.379620895022324`"], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.6702067218418446`*^9}]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.670206633758892*^9, {3.6702066993861213`*^9, 3.6702067273139553`*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ListLogLinearPlot", "[", 
  RowBox[{"c1a", ",", 
   RowBox[{"ImageSize", "\[Rule]", "270"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"Axes", "\[Rule]", "False"}], ",", 
   RowBox[{"FrameTicks", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "None"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<c\>\"", ",", "None"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<a\>\"", ",", "None"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<\[Alpha]=0.4,m=1\>\""}], ",", 
   RowBox[{"RotateLabel", "\[Rule]", "False"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
     "\"\<C:\\\\Users\\\\ASUS\\\\OneDrive\\\\Documents\\\\Test_6\\\\Plot_c1_\
veus_a.eps\>\"", ",", "%"}], "]"}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6693686032619433`*^9, 3.669368691169132*^9}, {
   3.6693687273610735`*^9, 3.6693689315820217`*^9}, {3.6693689778481417`*^9, 
   3.669369157709737*^9}, {3.6693693783527346`*^9, 3.66936938114964*^9}, {
   3.6693780100612106`*^9, 3.669378087202673*^9}, {3.669378118374881*^9, 
   3.6693781647347364`*^9}, {3.6693782014971895`*^9, 3.669378254006372*^9}, 
   3.6693796861685505`*^9, {3.6694185056883287`*^9, 3.66941851119724*^9}, 
   3.66959354385471*^9, {3.670152343111467*^9, 3.6701523896459217`*^9}, {
   3.6701524298626842`*^9, 3.670152437875407*^9}, {3.6702028177476425`*^9, 
   3.670202818099891*^9}, {3.670208725634218*^9, 3.6702087678179665`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MemoryInUse", "[", "$FrontEnd", "]"}], "/", "1024"}], "/", 
  "1024."}]], "Input",
 CellChangeTimes->{{3.670208790563757*^9, 3.6702088061638165`*^9}}]
}, Open  ]]
},
WindowSize->{1112, 791},
WindowMargins->{{Automatic, 49}, {Automatic, 61}},
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (February 25, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 128, 2, 49, "Subsection",
 InitializationGroup->True],
Cell[711, 26, 3828, 103, 321, "Input",
 InitializationCell->True,
 InitializationGroup->True],
Cell[4542, 131, 988, 31, 56, "Input",
 InitializationCell->True,
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[5555, 166, 786, 21, 74, "Input",
 InitializationCell->True,
 InitializationGroup->True],
Cell[6344, 189, 1340, 45, 82, "Output"]
}, Open  ]],
Cell[7699, 237, 138, 3, 31, "Input",
 InitializationCell->True,
 InitializationGroup->True],
Cell[7840, 242, 17762, 431, 1079, "Input",
 InitializationCell->True,
 InitializationGroup->True],
Cell[25605, 675, 2722, 72, 161, "Input",
 InitializationCell->True,
 InitializationGroup->True],
Cell[28330, 749, 4152, 98, 232, "Input",
 InitializationCell->True,
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[32507, 851, 1111, 31, 98, "Input",
 InitializationCell->True,
 InitializationGroup->True],
Cell[33621, 884, 925, 16, 24, "Message"],
Cell[34549, 902, 926, 16, 24, "Message"],
Cell[35478, 920, 925, 16, 24, "Message"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36452, 942, 190, 6, 49, "Subsection"],
Cell[36645, 950, 2619, 60, 182, "Input"],
Cell[39267, 1012, 156, 4, 31, "Input"],
Cell[CellGroupData[{
Cell[39448, 1020, 2817, 69, 204, "Input"],
Cell[CellGroupData[{
Cell[42290, 1093, 95, 2, 23, "Print"],
Cell[42388, 1097, 108, 2, 23, "Print"],
Cell[42499, 1101, 108, 2, 23, "Print"],
Cell[42610, 1105, 108, 2, 23, "Print"],
Cell[42721, 1109, 109, 2, 23, "Print"],
Cell[42833, 1113, 109, 2, 23, "Print"],
Cell[42945, 1117, 111, 2, 23, "Print"],
Cell[43059, 1121, 111, 2, 23, "Print"]
}, Open  ]],
Cell[43185, 1126, 130, 2, 31, "Output"]
}, Open  ]],
Cell[43330, 1131, 1882, 41, 92, "Input"],
Cell[45215, 1174, 197, 5, 31, "Input"]
}, Open  ]]
}
]
*)

